<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>RiverBot ëŒ€ì‹œë³´ë“œ</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>RiverBot ëŒ€ì‹œë³´ë“œ</h1>
  </header>

  <div class="main-wrapper">
    <!-- ì™¼ìª½ -->
    <section class="left-panel">
      <h2 id="detect-title">í˜„ì¬ ì¸ì‹ ì¤‘: <span class="highlight" id="trash-type">í”Œë¼ìŠ¤í‹±</span></h2>
      <p class="click-guide">5ë²ˆ í´ë¦­í•´ì£¼ì„¸ìš” ğŸ™‚</p>
      
      <img id="trashImage" 
           src="ntr202309190020.680x.0.jpg" 
           alt="í”Œë¼ìŠ¤í‹± ì“°ë ˆê¸°" 
           class="trash-photo"
           onclick="toggleTrashType()">

      <!-- ê·¸ë˜í”„ -->
      <div class="graph-container">
        <h3>ì‹¤ì‹œê°„ ì“°ë ˆê¸° ìˆ˜ê±°ëŸ‰</h3>
        <canvas id="plasticChart"></canvas>
      </div>

      <!-- GPS ì§€ë„ -->
      <div class="gps-container">
        <h3>GPS ìœ„ì¹˜ ì •ë³´</h3>
        <div class="map-area">
          <img src="1234.png" alt="ì§€ë„ ë°°ê²½" class="map-background">
          <div class="map-pin"></div>
        </div>
        <p class="gps-text">í˜„ì¬ ìœ„ì¹˜&nbsp;&nbsp;X: 4.2&nbsp;&nbsp;Y: 1.8</p>
      </div>
    </section>

    <!-- ì˜¤ë¥¸ìª½ -->
    <section class="right-panel">
      <div class="status-card">
        <h3>í”Œë¼ìŠ¤í‹± ìˆ˜ê±°ëŸ‰</h3>
        <div class="gauge" style="--val:52; --color:#4CAF50;">
          <div class="gauge-inner">
            <div class="percent">52%</div>
            <p>í˜„ì¬ ìˆ˜ê±°ìœ¨</p>
          </div>
        </div>
      </div>

      <div class="status-card" id="trash-card">
        <h3>ì¼ë°˜ ì“°ë ˆê¸° ìˆ˜ê±°ëŸ‰</h3>
        <div class="gauge" id="trash-gauge" style="--val:44; --color:#2196F3;">
          <div class="gauge-inner">
            <div class="percent" id="trash-percent">44%</div>
            <p>í˜„ì¬ ìˆ˜ê±°ìœ¨</p>
          </div>
        </div>
      </div>

      <div class="status-card" id="metal-card">
        <h3>ê¸ˆì† ì“°ë ˆê¸° ìˆ˜ê±°ëŸ‰</h3>
        <div class="gauge" id="metal-gauge" style="--val:28; --color:#FF9800;">
          <div class="gauge-inner">
            <div class="percent" id="metal-percent">28%</div>
            <p>í˜„ì¬ ìˆ˜ê±°ìœ¨</p>
          </div>
        </div>
      </div>

      <div class="status-card small">
        <h3>YOLO ì¸ì‹ë¥ </h3>
        <p class="yolo-val">98%</p>
      </div>
    </section>
  </div>

  <!-- ëª¨ë‹¬ -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <h2>âš ï¸ ì£¼ì˜!</h2>
      <p>ì“°ë ˆê¸° ê°€ë“ ì°¸</p>
      <button onclick="closeModal()">í™•ì¸</button>
    </div>
  </div>

  <footer>
    <p>Â© 2025 RiverBot Monitoring System</p>
  </footer>

  <script>
    // === ê·¸ë˜í”„ ===
    const ctx = document.getElementById('plasticChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['06ì‹œ','08ì‹œ','10ì‹œ','12ì‹œ','14ì‹œ','16ì‹œ','18ì‹œ','20ì‹œ','22ì‹œ'],
        datasets: [{
          label: 'ìˆ˜ê±°ëŸ‰ (í†¤)',
          data: [20, 30, 24, 45, 53],
          fill: true,
          borderColor: '#4CAF50',
          backgroundColor: 'rgba(76,175,80,0.1)',
          tension: 0.4,
          pointBackgroundColor: '#4CAF50',
          pointRadius: 4
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { title: { display: true, text: 'ì‹œê°„', color:'#555' }, grid:{ color:'#eee' } },
          y: { title: { display: true, text: 'ìˆ˜ê±°ëŸ‰ (í†¤)', color:'#555' }, beginAtZero:true, grid:{ color:'#eee' } }
        },
        plugins: { legend:{ display:false } }
      }
    });

    // === ìƒíƒœ ===
    let currentStage = 0; 

    const img = document.getElementById('trashImage');
    const typeText = document.getElementById('trash-type');
    const trashGauge = document.getElementById('trash-gauge');
    const trashPercent = document.getElementById('trash-percent');
    const metalGauge = document.getElementById('metal-gauge');
    const metalPercent = document.getElementById('metal-percent');
    const modal = document.getElementById('modal');

    const metalImages = [
      "KakaoTalk_20251107_035742633.jpg",
      "KakaoTalk_20251107_035742633_01.jpg",
      "KakaoTalk_20251107_035742633_02.jpg"
    ];

    function toggleTrashType() {
      if (currentStage === 0) {
        img.src = "KakaoTalk_20251107_031923454.jpg";
        typeText.textContent = "ì¼ë°˜ì“°ë ˆê¸°";
        animateGaugeChange(trashPercent, trashGauge, 44, 46, '#2196F3');
      } 
      else if (currentStage === 1) {
        img.src = metalImages[0];
        typeText.textContent = "ê¸ˆì†ì“°ë ˆê¸°";
        animateGaugeChange(metalPercent, metalGauge, 28, 48, '#FF9800');
      } 
      else if (currentStage === 2) {
        img.src = metalImages[1];
        typeText.textContent = "ê¸ˆì†ì“°ë ˆê¸°";
        animateGaugeChange(metalPercent, metalGauge, 48, 68, '#FF9800');
      } 
      else if (currentStage === 3) {
        img.src = metalImages[2];
        typeText.textContent = "ê¸ˆì†ì“°ë ˆê¸°";
        animateGaugeChange(metalPercent, metalGauge, 68, 88, '#FF9800');
        setTimeout(() => { modal.style.display = "flex"; }, 800);
      } 
      else if (currentStage >= 4) {
        img.src = "ntr202309190020.680x.0.jpg";
        typeText.textContent = "í”Œë¼ìŠ¤í‹±";
        animateGaugeChange(metalPercent, metalGauge, 88, 28, '#FF9800');
        animateGaugeChange(trashPercent, trashGauge, 46, 44, '#2196F3');
        modal.style.display = "none";
        currentStage = -1;
      }
      currentStage++;
    }

    function animateGaugeChange(elem, gauge, from, to, color) {
      let current = from;
      const step = from < to ? 0.3 : -0.3;
      const interval = setInterval(() => {
        current += step;
        const rounded = Math.round(current * 10) / 10;
        elem.textContent = rounded.toFixed(1) + '%';
        gauge.style.background = `conic-gradient(${color} ${rounded * 3.6}deg, #ddd 0deg)`;

        if ((step > 0 && current >= to) || (step < 0 && current <= to)) {
          elem.textContent = Math.round(to) + '%';
          gauge.style.background = `conic-gradient(${color} ${to * 3.6}deg, #ddd 0deg)`;
          clearInterval(interval);
        }
      }, 20);
    }

    function closeModal() {
      modal.style.display = "none";
    }
  </script>
</body>
</html>
